pico-8 cartridge // http://www.pico-8.com
version 16
__lua__
function _init()
	p1init()
end

function _update()
 if (btn(0)) then p1move(-1,0) end
 if (btn(1)) then p1move(1,0) end
 if (btn(2)) then p1move(0,-1) end
 if (btn(3)) then p1move(0,1) end
-- if (btn(0)) then p1.x=p1.x-1 end
-- if (btn(1)) then p1.x=p1.x+1 end
-- if (btn(2)) then p1.y=p1.y-1 end
-- if (btn(3)) then p1.y=p1.y+1 end
end

function _draw()
 cls()
 map(0,0,0,0)
 spr(1,p1.x,p1.y)
 debug()
end

function debug()
 print("p1.x "..p1.x.." "..tostr(istilesolid(pixeltotile(p1.x),pixeltotile(p1.y))), 0, 0, 10)
 print("p1.y "..p1.y, 0, 6, 10)
end

function pixeltotile(px) return flr(px / 8) end

function istilesolid(x,y) return fget(mget(x,y),0) end
function istilesolidpx(x,y) return istilesolid(pixeltotile(x),pixeltotile(y)) end
-->8
p1={}

function p1init()
 p1.x = 10
 p1.y = 20
 p1.sp= 1
 p1.tx=p1.x
 p1.ty=p1.y
end

function p1move(x,y,fast)
 local i
 if (x > 0) then
  i=p1.x
  while (p1.x < i+p1.sp) do
   if (istilesolidpx(p1.x+8,p1.y)) or (istilesolidpx(p1.x+8,p1.y+7)) then
    break
   end
   p1.x=p1.x+p1.sp
  end
 elseif (x < 0) then
  i=p1.x
  while (p1.x > i-p1.sp) do
   if (istilesolidpx(p1.x-1,p1.y)) or (istilesolidpx(p1.x-1,p1.y+7)) then
    break
   end
   p1.x=p1.x-p1.sp
  end
 end
 
 if (y > 0) then
  i=p1.y
  while (p1.y < i+p1.sp) do
   if (istilesolidpx(p1.x,p1.y+8)) or (istilesolidpx(p1.x+7,p1.y+8)) then
    break
   end
   p1.y=p1.y+p1.sp
  end
 elseif (y < 0) then
  i=p1.y
  while (p1.y > i-p1.sp) do
   if (istilesolidpx(p1.x,p1.y-1)) or (istilesolidpx(p1.x+7,p1.y-1)) then
    break
   end
   p1.y=p1.y-p1.sp
  end
 end
end
__gfx__
00000000009999000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000018881888
00000000099999900000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000b00000000000022212221
007007009991999000000000000000000000000000000000000000000000000000000000000000000000000000000000000000009900b0990a0a000081888188
00077000999999990000000000000000000000000000000000000000000000000000000000000000000000000000000000000000999999990090000012221222
0007700099cc91990000000000000000000000000000000000000000000000000000000000000000000000000000000000000000949499490a0a0b0088188818
00700700099cc9900000000000000000000000000000000000000000000000000000000000000000000000000000000000000000949499490000300021222122
000000000999c990000000000000000000000000000000000000000000000000000000000000000000000000000000000000000099949999000b030088818881
00000000009999000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000099999900000030022122212
__gff__
0000000000000000000000000000000100000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
__map__
0f0f0f0f0f0f0f0f0f0f0f0f0f0f0f0f00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
0f00000000000000000000000000000f00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
0f000000000000000d0000000000000f00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
0f0000000000000f0f0000000000000f00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
0f00000000000000000000000000000f00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
0f00000000000f00000000000000000f00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
0f00000f0f00000f0000000f0f00000f00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
0f000000000000000f0000000000000f00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
0f00000000000000000000000000000f00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
0f00000000000000000f00000000000f00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
0f000000000000000f0000000000000f00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
0f000f0f0f0f0f00000f0f0f0f0f000f00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
0f00000000000000000000000000000f00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
0f00000000000000000000000000000f00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
0f0000000e0000000000000e0e00000f00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
0f0f0f0f0f0f0f0f0f0f0f0f0f0f0f0f00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
